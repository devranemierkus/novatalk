<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<title>NovaTalk - Google AI Sesli Sohbet</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  body { font-family: Arial, sans-serif; padding: 20px; background:#121212; color:#eee; text-align:center;}
  button { font-size:18px; padding:15px 30px; margin:10px; border:none; border-radius:20px; cursor:pointer;}
  #btnStart { background:#4caf50; color:#fff;}
  #btnStop { background:#d32f2f; color:#fff; display:none;}
  #log { background:#222; padding:15px; margin-top:20px; max-width:600px; margin-left:auto; margin-right:auto; border-radius:15px; min-height:100px; white-space:pre-wrap;}
</style>
</head>
<body>

<h1>NovaTalk - Google AI Sesli Sohbet</h1>
<button id="btnStart">ğŸ¤ KonuÅŸmaya BaÅŸla</button>
<button id="btnStop">ğŸ›‘ KonuÅŸmayÄ± Durdur</button>

<div id="log">Loglar burada gÃ¶sterilecek...</div>

<script>
const btnStart = document.getElementById('btnStart');
const btnStop = document.getElementById('btnStop');
const log = document.getElementById('log');

let recognition;
let recognizing = false;

btnStart.onclick = () => {
  if (recognizing) return;
  startRecognition();
};

btnStop.onclick = () => {
  if (!recognizing) return;
  stopRecognition();
};

function logYaz(mesaj) {
  log.textContent += '\n' + mesaj;
  log.scrollTop = log.scrollHeight;
}

function startRecognition() {
  if (!('webkitSpeechRecognition' in window || 'SpeechRecognition' in window)) {
    alert('TarayÄ±cÄ±nÄ±z ses tanÄ±mayÄ± desteklemiyor!');
    return;
  }
  const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
  recognition = new SpeechRecognition();
  recognition.lang = 'tr-TR';
  recognition.interimResults = false;
  recognition.continuous = true;

  recognition.onstart = () => {
    recognizing = true;
    btnStart.style.display = 'none';
    btnStop.style.display = 'inline-block';
    logYaz('ğŸ™ï¸ Dinleniyor...');
  };

  recognition.onresult = async (event) => {
    const lastIndex = event.results.length -1;
    const text = event.results[lastIndex][0].transcript.trim();
    logYaz('ğŸ‘¤ Sen: ' + text);
    // Google AI Chat API'ye gÃ¶nderip cevap al
    const cevap = await googleChatApiSorgula(text);
    botKonus(cevap);
  };

  recognition.onerror = (event) => {
    logYaz('âš ï¸ Hata: ' + event.error);
  };

  recognition.onend = () => {
    recognizing = false;
    btnStart.style.display = 'inline-block';
    btnStop.style.display = 'none';
    logYaz('ğŸ›‘ Dinleme durdu.');
  };

  recognition.start();
}

function stopRecognition() {
  if (recognition) {
    recognition.stop();
  }
}

function botKonus(text) {
  const utter = new SpeechSynthesisUtterance(text);
  utter.lang = 'tr-TR';
  speechSynthesis.speak(utter);
  logYaz('ğŸ¤– ChatNova: ' + text);
}

// Google Chat API Ã§aÄŸrÄ±sÄ± - NOT: Burada gerÃ§ek API Ã§aÄŸrÄ±sÄ± yapÄ±lmÄ±yor, bunu backend Ã¼zerinden yapmalÄ±sÄ±n!
// AÅŸaÄŸÄ±da Ã¶rnek mock cevap var:
async function googleChatApiSorgula(metin) {
  logYaz('... Google AI sorgulanÄ±yor ...');
  // Burada fetch ile kendi backend'inize veya Google AI endpointine POST yapacaksÄ±nÄ±z.
  // Ã–rnek: 
  /*
  const response = await fetch('https://your-backend.com/google-chat', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer API_KEY' },
    body: JSON.stringify({ message: metin }),
  });
  const data = await response.json();
  return data.reply;
  */
  // Åimdilik sabit cevap dÃ¶nÃ¼yorum:
  return new Promise(resolve => setTimeout(() => resolve('Merhaba, ben NovaTalk! Åu an gerÃ§ek API baÄŸlanmadÄ±.'), 1000));
}

</script>

</body>
</html>
